// Generated by CoffeeScript 1.6.3
(function() {
  this.AppItemShow = (function() {
    function AppItemShow() {}

    AppItemShow.showConfirmReservationDialog = function(success_callback) {
      var title;
      title = ($('.app-title')).text();
      return bootbox.dialog({
        message: ($('#tmpl-reservation-form')).html(),
        title: "<b>" + title + "</b> を予約しますか？"
      });
    };

    AppItemShow.registerCallback = function() {
      var callback;
      callback = function() {
        if (gon.user_id != null) {
          return AppItemShow.showConfirmReservationDialog(function() {
            return Reservation.reserve(gon.app_item_id);
          });
        } else {
          return AuthDialog.show('この機能を利用するにはログインが必要です。');
        }
      };
      return ($('.reservation-btn')).click(callback);
    };

    return AppItemShow;

  })();

  $(document).on('ready page:load', function() {
    var $frame, $wrap;
    if (URLHelper.isAppUrl(location.href)) {
      AppItemShow.registerCallback();
      $frame = $("#effects");
      $wrap = $frame.parent();
      return $frame.sly({
        horizontal: 1,
        itemNav: "forceCentered",
        smart: 1,
        activateMiddle: 1,
        activateOn: "click",
        mouseDragging: 1,
        touchDragging: 1,
        releaseSwing: 1,
        startAt: 0,
        scrollBar: $wrap.find(".scrollbar"),
        scrollBy: 1,
        speed: 300,
        elasticBounds: 1,
        easing: "swing",
        dragHandle: 1,
        dynamicHandle: 1,
        clickBar: 1
      });
    }
  });

}).call(this);
